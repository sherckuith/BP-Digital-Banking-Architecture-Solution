| ID | Título | Justificaciones |
| :--- | :--- | :--- |
| **ADR-001** | Micro-servicios por dominios (DDD) + BFF por canal | 1. *High Cohesion* y *Loose Coupling* mediante *bounded contexts*. <br> 2. BFF permite *payload optimisation* y mantiene los *tokens* en el servidor (**Zero-Trust**). |
| **ADR-002** | API Gateway + WAF + rate-limiting | 1. Centraliza seguridad (**OWASP Top 10**) y protección DDoS. <br> 2. *Latency mitigation*: bloquea tráfico malicioso antes de que alcance los micro-servicios. |
| **ADR-003** | OIDC Auth Code + PKCE (FAPI 2.0) | 1. **PKCE** elimina riesgo de *code-interception*. <br> 2. **DPoP** enlaza *token* a clave del cliente, cumpliendo con **FAPI 2.0** (*sender-constraining*). |
| **ADR-004** | Step-up MFA basado en riesgo | 1. Reduce fraude sin degradar UX (solo cuando monto > MTU, nuevo beneficiario, etc.). <br> 2. Cumple con **CNBV 12-E** que obliga MFA reforzado para transacciones de riesgo. |
| **ADR-005** | ACL para Core y Customer-360 | 1. *Loose Coupling* protege al dominio interno de cambios de contrato del *Core Legacy*. <br> 2. *Circuit-Breaker* evita propagación de latencias o caídas del *Core* a los micro-servicios. |
| **ADR-006** | Event-driven para notificaciones / auditoría / proyecciones | 1. Desacopla productores y consumidores → *scalability* y *extensibilidad*. <br> 2. *Eventual Consistency* aceptada para lecturas, mientras la transacción permanece en estado *pending*. |
| **ADR-007** | Outbox Pattern | 1. Garantiza *exactly-once* publicación de eventos sin 2PC. <br> 2. Desacopla la transacción de la mensajería, reduciendo *latency* en la capa de negocio. |
| **ADR-008** | Idempotency-Key en Transfers | 1. Evita duplicación aun con re-intentos de red. <br> 2. Implementado en el BFF permite control centralizado y registro en la tabla `transfer_idempotency`. |
| **ADR-009** | Audit ledger *append-only* + WORM + *hash-chain* | 1. Detecta cualquier alteración mediante verificación de cadena de *hashes*. <br> 2. **WORM** en S3 Glacier cumple con requisitos de retención de 7 años (**PCI-DSS, CNBV**). |
| **ADR-010** | CQRS ligero + *read model* para lecturas | 1. *Latency mitigation*: lecturas ultra-rápidas (< 10 ms) sin cargar la base transaccional. <br> 2. *Eventual Consistency* aceptada para datos de historial, reconstruidos a partir de eventos. |
| **ADR-011** | Redis HA para datos *hot* y clientes frecuentes | 1. *Low latency* de < 10 ms para datos de cliente y límites MTU. <br> 2. *High Availability Multi-AZ* con *fail-over* automático, garantizando *resiliencia*. |
| **ADR-012** | Notificaciones (≥ 2 canales) - Push + SMS/WhatsApp | 1. **Redundancia** requerida por normativa (notificar por al menos dos canales). <br> 2. *Cost-latency trade-off*: *push* es instantáneo, SMS/WhatsApp sirve como *backup* fiable. |
| **ADR-013** | Observabilidad con OpenTelemetry | 1. Evita *vendor lock-in* y permite *tracing end-to-end*. <br> 2. Mejora MTTR mediante correlación de *logs*, métricas y trazas. |
| **ADR-014** | HA *multi-AZ* + DR *warm-standby* *multi-región* | 1. **RTO < 5 min** y **RPO ≈ 0 s** gracias a Aurora Global, DynamoDB Global Tables y Global Accelerator. <br> 2. *Cost-balance*: *warm-standby* reduce coste frente a un *full active-active*. |
| **ADR-015** | *Secret management* con KMS/KeyVault | 1. Almacena secretos bajo **AES-256-GCM** y rota automáticamente. <br> 2. Auditable: *CloudTrail* registra cada acceso, cumpliendo con PCI-DSS 3.2 y LOPDP. |
| **ADR-016** | CI/CD con SAST/DAST/SBOM + firmas OCI | 1. Detecta vulnerabilidades en *stage* (*pre-prod*) reduciendo *surface-of-attack*. <br> 2. SBOM + Cosign garantizan integridad del artefacto en producción (*Supply-Chain Security*). |
| **ADR-017** | DB por dominio + ABAC/OPA + *masking* | 1. Limita movimiento lateral de datos sensibles (principio *least privilege*). <br> 2. *Masking/Tokenization* cumple con LOPDP y facilita auditorías. |
| **ADR-018** | Arquitectura híbrida *cloud* primario + *on-prem fail-over* | 1. *Data-sovereignty*: datos críticos pueden permanecer en Ecuador bajo control local. <br> 2. *Resilience*: Outposts brinda una ruta de *fail-over* completa ante caída total de la región *cloud*. |
